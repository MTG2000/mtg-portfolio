{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport cookie from \"cookie\";\nimport Router from \"next/router\";\nexport function withAuthServerSideProps(getServerSidePropsFunc) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n      var user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getUser(context);\n\n            case 2:\n              user = _context.sent;\n\n              if (!getServerSidePropsFunc) {\n                _context.next = 10;\n                break;\n              }\n\n              _context.t0 = user;\n              _context.next = 7;\n              return getServerSidePropsFunc(context, user);\n\n            case 7:\n              _context.t1 = _context.sent;\n              _context.t2 = {\n                user: _context.t0,\n                data: _context.t1\n              };\n              return _context.abrupt(\"return\", {\n                props: _context.t2\n              });\n\n            case 10:\n              return _context.abrupt(\"return\", {\n                props: {\n                  user: user,\n                  data: {\n                    props: {\n                      user: user\n                    }\n                  }\n                }\n              });\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}\n\nfunction getUser(_x2) {\n  return _getUser.apply(this, arguments);\n} // withAuthComponent.js\n\n\nfunction _getUser() {\n  _getUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(context) {\n    var _cookie$parse, _cookie$parse$accessT, accessToken;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _cookie$parse = cookie.parse(context.req.headers.cookie || \"\"), _cookie$parse$accessT = _cookie$parse.accessToken, accessToken = _cookie$parse$accessT === void 0 ? \"\" : _cookie$parse$accessT; //   IF not authorized , redirect to login\n\n            if (!accessToken) {\n              context.res.writeHead(302, {\n                Location: \"/login\"\n              });\n              context.res.end();\n            }\n\n            return _context2.abrupt(\"return\", {\n              accessToken: accessToken\n            });\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _getUser.apply(this, arguments);\n}\n\nexport function withAuthComponent(Component) {\n  return function (_ref2) {\n    var user = _ref2.user,\n        data = _ref2.data;\n\n    if (!user) {\n      Router.push(\"/login\");\n    }\n\n    return __jsx(Component, data.props);\n  };\n}","map":null,"metadata":{},"sourceType":"module"}